version: '3.2'

services:
    db:
        build:
            context: ./postgres
            cache_from:
                - feeder_db:latest
        environment:
            - POSTGRES_PASSWORD=postgres
        volumes:
            - postgres-data:/var/lib/postgresql/data
    feed:
        user: root
        build:
          context: .
          cache_from:
            - feeder_feed:latest
        environment:
            - POSTGRES_PASSWORD=postgres
            - POSTGRES_HOST=db
            - POSTGRES_SCHEMA=monitoring_platform
        volumes:
            - .:/code
        depends_on:
            - db

volumes:
    postgres-data:
